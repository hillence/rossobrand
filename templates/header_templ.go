// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func Header(isAuthenticated bool, showLogout bool) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<header class=\"site-header\" data-authenticated=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(map[bool]string{true: "true", false: "false"}[isAuthenticated])
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `templates/header.templ`, Line: 4, Col: 115}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\"><div class=\"container site-header__inner\"><button type=\"button\" class=\"site-burger\" data-menu-toggle aria-expanded=\"false\" aria-label=\"Открыть меню\"><span class=\"site-burger__icon\" aria-hidden=\"true\"><span class=\"site-burger__line site-burger__line--top\"></span> <span class=\"site-burger__line site-burger__line--bottom\"></span></span></button><div class=\"site-header__brand\" style=\"width:134px;height:48px;\"><div class=\"site-header__brand-logo\"><img src=\"/static/image/ROSSO.svg\" alt=\"ROSSO\"></div></div><nav class=\"site-header__nav\" aria-label=\"Основная навигация\"><button type=\"button\" class=\"site-nav__item site-nav__item--desktop\" data-nav-item data-nav-key=\"catalog\" aria-expanded=\"false\"><span class=\"site-nav__label\">каталог</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button> <button type=\"button\" class=\"site-nav__item site-nav__item--desktop\" data-nav-item data-nav-key=\"customers\" aria-expanded=\"false\"><span class=\"site-nav__label\">покупателям</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button> <button type=\"button\" class=\"site-nav__item site-nav__item--desktop\" data-nav-item data-nav-key=\"about\" aria-expanded=\"false\"><span class=\"site-nav__label\">о нас</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button></nav><div class=\"site-header__actions\"><button type=\"button\" class=\"site-header__search\" data-search-toggle aria-expanded=\"false\" aria-controls=\"site-header-search-panel\">что хотите найти?</button><div class=\"site-header__icon-group\"><a href=\"/favorites\" class=\"site-header__icon-link site-header__icon-link--favorites\" aria-label=\"Избранное\" data-header-favorites><img src=\"/static/image/favorites.svg\" alt=\"\" class=\"site-header__icon-image\" aria-hidden=\"true\"></a> <a href=\"/cart\" class=\"site-header__icon-link site-header__icon-link--cart\" aria-label=\"Корзина\" data-header-cart><img src=\"/static/image/cart.svg\" alt=\"\" class=\"site-header__icon-image\" aria-hidden=\"true\"></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if isAuthenticated {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "<a href=\"/personal\" class=\"site-header__icon-link site-header__icon-link--profile\" aria-label=\"Личный кабинет\"><img src=\"/static/image/profile.svg\" alt=\"\" class=\"site-header__icon-image\" aria-hidden=\"true\"></a>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		} else {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<a href=\"#\" class=\"site-header__icon-link site-header__icon-link--profile\" aria-label=\"Войти\" role=\"button\" data-login-open=\"true\" aria-haspopup=\"dialog\" aria-controls=\"login-panel\"><img src=\"/static/image/profile.svg\" alt=\"\" class=\"site-header__icon-image\" aria-hidden=\"true\"></a>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "</div></div></div><div class=\"site-header__dropdown\" data-nav-panel><div class=\"site-header__dropdown-inner\"><div class=\"site-header__dropdown-content\"><div class=\"site-header__dropdown-section\" data-nav-content=\"catalog\"><ul class=\"site-header__dropdown-list\"><li><a href=\"#\" class=\"site-header__dropdown-link\">новинки</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">одежда</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">обувь</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">aксессуары</a></li></ul></div><div class=\"site-header__dropdown-section\" data-nav-content=\"customers\"><ul class=\"site-header__dropdown-list\"><li><a href=\"#\" class=\"site-header__dropdown-link\">оплата и доставка</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">возврат и гарантия</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">вопросы и ответы</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">программа лояльности</a></li></ul></div><div class=\"site-header__dropdown-section\" data-nav-content=\"about\"><ul class=\"site-header__dropdown-list\"><li><a href=\"#\" class=\"site-header__dropdown-link\">о бренде</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">магазины</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">контакты</a></li><li><a href=\"#\" class=\"site-header__dropdown-link\">лукбук</a></li></ul></div></div><div class=\"site-header__dropdown-media\"><img src=\"\" alt=\"Каталог\" class=\"site-header__dropdown-image\" data-nav-image=\"catalog\" hidden> <img src=\"\" alt=\"Покупателям\" class=\"site-header__dropdown-image\" data-nav-image=\"customers\" hidden> <img src=\"\" alt=\"О нас\" class=\"site-header__dropdown-image\" data-nav-image=\"about\" hidden></div></div></div></header><div class=\"site-header__search-overlay\" data-search-overlay aria-hidden=\"true\"><div class=\"container\"><div class=\"site-header__search-bar\" data-search-bar aria-hidden=\"true\"><input type=\"search\" class=\"site-header__search-input\" data-search-input placeholder=\"Введите запрос\"> <button type=\"button\" class=\"btn-primary site-header__search-submit\" data-search-submit>Найти</button> <button type=\"button\" class=\"site-header__search-close\" data-search-close aria-label=\"Закрыть поиск\">Закрыть</button></div></div><div class=\"site-header__search-panel\" id=\"site-header-search-panel\" data-search-panel aria-hidden=\"true\"><div class=\"container\"><div class=\"site-header__search-panel-inner\" data-search-panel-inner></div></div></div></div><div class=\"site-menu\" data-site-menu aria-hidden=\"true\"><div class=\"site-menu__panel\"><nav class=\"site-nav\" aria-label=\"Основная навигация\"><button type=\"button\" class=\"site-nav__item site-nav__item--panel\" data-nav-item data-nav-key=\"catalog\" aria-expanded=\"false\"><span class=\"site-nav__label\">Каталог</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button> <button type=\"button\" class=\"site-nav__item site-nav__item--panel\" data-nav-item data-nav-key=\"customers\" aria-expanded=\"false\"><span class=\"site-nav__label\">Покупателям</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button> <button type=\"button\" class=\"site-nav__item site-nav__item--panel\" data-nav-item data-nav-key=\"about\" aria-expanded=\"false\"><span class=\"site-nav__label\">О нас</span> <span class=\"site-nav__icon\" aria-hidden=\"true\"><svg width=\"9.8\" height=\"4.8\" viewBox=\"0 0 10 5\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0.5 0.5L5 4.3L9.5 0.5\" stroke=\"currentColor\" stroke-width=\"0.9\" stroke-linecap=\"round\" stroke-linejoin=\"round\"></path></svg></span></button></nav><div class=\"site-menu__actions\"><div class=\"site-header__quick-links site-header__quick-links--menu\"><button type=\"button\" class=\"site-header__search\">что то хотите найти?</button></div></div></div></div><div class=\"login-panel\" data-login-panel aria-hidden=\"true\" id=\"login-panel\"><div class=\"login-panel__overlay\" data-login-overlay aria-hidden=\"true\"></div><div class=\"login-panel__drawer\" data-login-drawer role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"login-panel-title\"><button type=\"button\" class=\"login-panel__close\" data-login-close aria-label=\"Закрыть окно\"><span class=\"login-panel__close-line\"></span> <span class=\"login-panel__close-line\"></span></button><div class=\"login-panel__content\"><h2 class=\"login-panel__title\" id=\"login-panel-title\">войти или зарегистрироваться</h2><form class=\"login-panel__form\" method=\"POST\" action=\"/login\" data-login-form><label class=\"login-panel__field\"><span class=\"login-panel__label\">почта</span> <input type=\"email\" name=\"email\" class=\"login-panel__input\" placeholder=\"example@mail.com\" required data-login-email></label> <label class=\"login-panel__field login-panel__field--password\"><span class=\"login-panel__label\">пароль</span> <input type=\"password\" name=\"password\" class=\"login-panel__input\" placeholder=\"Введите пароль\" required></label> <button type=\"submit\" class=\"login-panel__submit\">войти</button></form><button type=\"button\" class=\"login-panel__register\" data-register-open>создать новый аккаунт</button> <button type=\"button\" class=\"login-panel__forgot\" data-forgot-open>забыли пароль?</button></div></div></div><div class=\"register-panel\" data-register-panel aria-hidden=\"true\" id=\"register-panel\"><div class=\"login-panel__overlay\" data-register-overlay aria-hidden=\"true\"></div><div class=\"login-panel__drawer\" data-register-drawer role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"register-panel-title\"><button type=\"button\" class=\"login-panel__close\" data-register-close aria-label=\"Закрыть окно\"><span class=\"login-panel__close-line\"></span> <span class=\"login-panel__close-line\"></span></button><div class=\"login-panel__content register-panel__content\"><h2 class=\"login-panel__title\" id=\"register-panel-title\">зарегистрироваться</h2><form class=\"login-panel__form register-panel__form\" method=\"POST\" action=\"/register\" data-register-form><div class=\"register-panel__row\"><label class=\"login-panel__field\"><span class=\"login-panel__label\">имя</span> <input type=\"text\" name=\"first_name\" class=\"login-panel__input\" placeholder=\"Имя\" required></label> <label class=\"login-panel__field\"><span class=\"login-panel__label\">фамилия</span> <input type=\"text\" name=\"last_name\" class=\"login-panel__input\" placeholder=\"Фамилия\" required></label></div><label class=\"login-panel__field\"><span class=\"login-panel__label\">почта</span> <input type=\"email\" name=\"email\" class=\"login-panel__input\" placeholder=\"example@mail.com\" required></label> <label class=\"login-panel__field\"><span class=\"login-panel__label\">телефон</span> <input type=\"tel\" name=\"phone\" class=\"login-panel__input\" placeholder=\"+7 (___) ___-__-__\" required></label> <label class=\"login-panel__field\"><span class=\"login-panel__label\">придумайте пароль</span> <input type=\"password\" name=\"password\" class=\"login-panel__input\" placeholder=\"Пароль\" required data-register-password></label> <label class=\"login-panel__field\"><span class=\"login-panel__label\">повторите пароль</span> <input type=\"password\" name=\"confirm_password\" class=\"login-panel__input\" placeholder=\"Повторите пароль\" required data-register-confirm></label> <button type=\"submit\" class=\"login-panel__submit register-panel__submit\" data-register-submit disabled>зарегистрироваться</button> <label class=\"register-panel__checkbox\"><input type=\"checkbox\" name=\"terms_agree\" required> <span>Я ознакомился и согласен с условиями Пользовательского соглашения и приложений к нему, включая Общие условия агентского договора по приобретению и доставке товаров, Правилами совершения платежей и возврата оплаты, Политикой обработки персональных данных и файлов Cookie.</span></label></form></div></div></div><div class=\"forgot-panel\" data-forgot-panel aria-hidden=\"true\" id=\"forgot-panel\"><div class=\"login-panel__overlay\" data-forgot-overlay aria-hidden=\"true\"></div><div class=\"login-panel__drawer\" data-forgot-drawer role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"forgot-panel-title\"><button type=\"button\" class=\"login-panel__close\" data-forgot-close aria-label=\"Закрыть окно\"><span class=\"login-panel__close-line\"></span> <span class=\"login-panel__close-line\"></span></button><div class=\"login-panel__content\"><h2 class=\"login-panel__title\" id=\"forgot-panel-title\">восстановить доступ</h2><form class=\"login-panel__form forgot-panel__form\" method=\"POST\" action=\"/password/restore\" data-forgot-form><label class=\"login-panel__field\"><span class=\"login-panel__label\">почта</span> <input type=\"email\" name=\"email\" class=\"login-panel__input\" placeholder=\"example@mail.com\" required data-forgot-email></label> <button type=\"submit\" class=\"login-panel__submit forgot-panel__submit\">восстановить доступ</button></form></div></div></div><script>\n        (function () {\n            var doc = document;\n            var body = doc.body;\n            var header = doc.querySelector('.site-header');\n            var burger = doc.querySelector('[data-menu-toggle]');\n            var menu = doc.querySelector('[data-site-menu]');\n            var dropdown = doc.querySelector('[data-nav-panel]');\n            var desktopNavItems = doc.querySelectorAll('.site-nav__item--desktop');\n            var menuNavItems = menu ? menu.querySelectorAll('.site-nav__item--panel') : [];\n            var dropdownSections = dropdown ? dropdown.querySelectorAll('[data-nav-content]') : [];\n            var dropdownImages = dropdown ? dropdown.querySelectorAll('[data-nav-image]') : [];\n            var desktopBreakpoint = window.matchMedia('(min-width: 1024px)');\n            var activeDesktopItem = null;\n            var dropdownScrollPosition = 0;\n            var favoritesLinks = doc.querySelectorAll('.site-header__icon-link--favorites');\n            var searchToggle = doc.querySelector('[data-search-toggle]');\n            var searchBar = doc.querySelector('[data-search-bar]');\n            var searchInput = searchBar ? searchBar.querySelector('[data-search-input]') : null;\n            var searchSubmit = searchBar ? searchBar.querySelector('[data-search-submit]') : null;\n            var searchClose = doc.querySelector('[data-search-close]');\n            var searchPanel = doc.querySelector('[data-search-panel]');\n            var searchPanelInner = doc.querySelector('[data-search-panel-inner]');\n            var searchOverlay = doc.querySelector('[data-search-overlay]');\n            var searchActive = false;\n            var searchAbortController = null;\n            var menuImageMap = {};\n\n            if (window.location.pathname === '/favorites' && favoritesLinks.length) {\n                Array.prototype.forEach.call(favoritesLinks, function (link) {\n                    link.classList.add('is-active');\n                });\n            }\n\n            function escapeHTML(value) {\n                if (!value) { return ''; }\n                return value.replace(/[&<>\"']/g, function (char) {\n                    switch (char) {\n                        case '&': return '&amp;';\n                        case '<': return '&lt;';\n                        case '>': return '&gt;';\n                        case '\"': return '&quot;';\n                        case '\\'': return '&#39;';\n                        default: return char;\n                    }\n                });\n            }\n\n            function syncSearchInputWidth() {\n                if (!searchInput || !header) { return; }\n                var reference = header.querySelector('.site-header__auth-button');\n                if (!reference) { return; }\n                var rect = reference.getBoundingClientRect();\n                if (!rect || !rect.width) { return; }\n                searchInput.style.width = Math.round(rect.width) + 'px';\n            }\n\n            function formatPrice(value) {\n                var number = Number(value);\n                if (Number.isFinite(number)) {\n                    return new Intl.NumberFormat('ru-RU', {\n                        style: 'currency',\n                        currency: 'RUB',\n                        minimumFractionDigits: 0,\n                        maximumFractionDigits: 0\n                    }).format(number);\n                }\n                if (typeof value === 'string' && value.trim()) {\n                    return value;\n                }\n                return '';\n            }\n\n            function buildResultCard(item) {\n                var id = item && typeof item.id === 'number' ? item.id : null;\n                var name = escapeHTML(item && item.name ? String(item.name) : '');\n                var price = formatPrice(item && item.price);\n                var imageUrl = escapeHTML(item && item.image_url ? String(item.image_url) : '');\n                var href = escapeHTML(item && item.url ? String(item.url) : (id ? '/products/' + id : '#'));\n                var imageMarkup = imageUrl\n                    ? '<img class=\"site-header__search-result-img\" src=\"' + imageUrl + '\" alt=\"' + name + '\"/>'\n                    : '<div class=\"site-header__search-result-image\" aria-hidden=\"true\"></div>';\n                return '<article class=\"site-header__search-result\"><a class=\"site-header__search-result-link\" href=\"' + href + '\">' + imageMarkup + '<h4 class=\"site-header__search-result-title\">' + name + '</h4><p class=\"site-header__search-result-price\">' + price + '</p></a></article>';\n            }\n\n            function updateSearchPanelContent(query, items, options) {\n                if (!searchPanelInner) { return; }\n                options = options || {};\n                if (options.loading) {\n                    searchPanelInner.innerHTML = '<p class=\"site-header__search-title\">Поиск...</p>';\n                    if (searchPanel) {\n                        searchPanel.classList.add('is-open');\n                        searchPanel.setAttribute('aria-hidden', 'false');\n                    }\n                    return;\n                }\n                if (options.error) {\n                    searchPanelInner.innerHTML = '<p class=\"site-header__search-title\">' + escapeHTML(options.error) + '</p>';\n                    if (searchPanel) {\n                        searchPanel.classList.add('is-open');\n                        searchPanel.setAttribute('aria-hidden', 'false');\n                    }\n                    return;\n                }\n                var trimmed = (query || '').trim();\n                if (!trimmed) {\n                    searchPanelInner.innerHTML = '';\n                    if (searchPanel) {\n                        searchPanel.classList.remove('is-open');\n                        searchPanel.setAttribute('aria-hidden', 'true');\n                    }\n                    return;\n                }\n                if (!items || !items.length) {\n                    var safeQuery = escapeHTML(trimmed);\n                    searchPanelInner.innerHTML = '<p class=\"site-header__search-title\">По запросу \"' + safeQuery + '\" ничего не найдено.</p>';\n                    if (searchPanel) {\n                        searchPanel.classList.add('is-open');\n                        searchPanel.setAttribute('aria-hidden', 'false');\n                    }\n                    return;\n                }\n                var safeQuery = escapeHTML(trimmed);\n                var cards = items.map(buildResultCard).join('');\n                searchPanelInner.innerHTML = '<p class=\"site-header__search-title\">Результаты для: \"' + safeQuery + '\"</p><div class=\"site-header__search-results\">' + cards + '</div>';\n                if (searchPanel) {\n                    searchPanel.classList.add('is-open');\n                    searchPanel.setAttribute('aria-hidden', 'false');\n                }\n            }\n\n            function performSearch(query) {\n                if (!searchPanelInner) { return; }\n                var trimmed = query.trim();\n                if (!trimmed) {\n                    updateSearchPanelContent('', []);\n                    return;\n                }\n                if (typeof AbortController === 'function') {\n                    if (searchAbortController) {\n                        searchAbortController.abort();\n                    }\n                    searchAbortController = new AbortController();\n                }\n                updateSearchPanelContent(trimmed, [], { loading: true });\n                fetch('/search?q=' + encodeURIComponent(trimmed), {\n                    headers: {\n                        'Accept': 'application/json'\n                    },\n                    signal: searchAbortController ? searchAbortController.signal : undefined\n                }).then(function (response) {\n                    if (!response.ok) {\n                        throw new Error('search failed');\n                    }\n                    return response.json();\n                }).then(function (data) {\n                    var items = data && Array.isArray(data.results) ? data.results : [];\n                    updateSearchPanelContent(trimmed, items);\n                    searchAbortController = null;\n                }).catch(function (error) {\n                    if (error && error.name === 'AbortError') {\n                        return;\n                    }\n                    updateSearchPanelContent(trimmed, [], { error: 'Не удалось выполнить поиск. Попробуйте позже.' });\n                    searchAbortController = null;\n                });\n            }\n\n            function hideDropdownImages() {\n                if (!dropdownImages) { return; }\n                dropdownImages.forEach(function (img) {\n                    img.hidden = true;\n                });\n            }\n\n            function updateDropdownImage(sectionKey) {\n                if (!dropdownImages || !sectionKey) { return; }\n                dropdownImages.forEach(function (img) {\n                    var match = img.getAttribute('data-nav-image') === sectionKey;\n                    if (match && menuImageMap && menuImageMap[sectionKey]) {\n                        if (img.src !== menuImageMap[sectionKey]) {\n                            img.src = menuImageMap[sectionKey];\n                        }\n                        img.hidden = false;\n                    } else {\n                        img.hidden = true;\n                    }\n                });\n            }\n\n            function loadMenuImages() {\n                fetch('/menu/sections')\n                    .then(function (response) { return response.json(); })\n                    .then(function (data) {\n                        if (data && data.sections) {\n                            menuImageMap = data.sections;\n                            if (activeDesktopItem) {\n                                var key = activeDesktopItem.getAttribute('data-nav-key');\n                                updateDropdownImage(key);\n                            }\n                        }\n                    })\n                    .catch(function () {\n                        menuImageMap = {};\n                    });\n            }\n\n            function setSearchState(open) {\n                if (!header) { return; }\n                if (open) {\n                    syncSearchInputWidth();\n                    setMenuState(false);\n                    closeDesktopDropdown();\n                }\n                header.classList.toggle('site-header--search-open', open);\n                body.classList.toggle('body--search-open', open);\n                if (searchToggle) {\n                    searchToggle.setAttribute('aria-expanded', String(open));\n                }\n            if (searchBar) {\n                searchBar.setAttribute('aria-hidden', String(!open));\n            }\n            if (searchOverlay) {\n                searchOverlay.setAttribute('aria-hidden', String(!open));\n            }\n                if (searchPanel) {\n                    if (!open) {\n                        searchPanel.classList.remove('is-open');\n                        searchPanel.setAttribute('aria-hidden', 'true');\n                        if (searchPanelInner) {\n                            searchPanelInner.innerHTML = '';\n                        }\n                    } else {\n                        searchPanel.setAttribute('aria-hidden', 'true');\n                    }\n                }\n                if (open && searchInput) {\n                    window.requestAnimationFrame(function () {\n                        searchInput.focus();\n                        searchInput.select();\n                    });\n                    if (!searchInput.value.trim()) {\n                        updateSearchPanelContent('', []);\n                    }\n                }\n                if (!open && searchInput) {\n                    if (searchAbortController) {\n                        searchAbortController.abort();\n                        searchAbortController = null;\n                    }\n                    searchInput.value = '';\n                    updateSearchPanelContent('', []);\n                }\n                searchActive = open;\n            }\n\n            function toggleSearch(event) {\n                if (event) {\n                    event.preventDefault();\n                }\n                setSearchState(!searchActive);\n            }\n\n            function handleSearchSubmit(event) {\n                if (event) {\n                    event.preventDefault();\n                }\n                if (!searchInput) { return; }\n                var value = searchInput.value.trim();\n                if (!searchActive) {\n                    setSearchState(true);\n                }\n                if (!value) {\n                    updateSearchPanelContent('', []);\n                    return;\n                }\n                performSearch(value);\n            }\n\n            function handleSearchInput() {\n                if (!searchInput) { return; }\n                var text = searchInput.value.trim();\n                if (!searchActive) {\n                    setSearchState(true);\n                }\n                if (!text) {\n                    if (searchAbortController) {\n                        searchAbortController.abort();\n                        searchAbortController = null;\n                    }\n                    updateSearchPanelContent('', []);\n                }\n            }\n\n            updateSearchPanelContent('', []);\n\n            function resetMenuNav() {\n                menuNavItems.forEach(function (item) {\n                    item.setAttribute('aria-expanded', 'false');\n                    item.classList.remove('site-nav__item--active');\n                });\n            }\n\n            function setMenuState(open) {\n                if (!burger || !menu) { return; }\n                burger.setAttribute('aria-expanded', String(open));\n                burger.classList.toggle('site-burger--open', open);\n                menu.classList.toggle('site-menu--open', open);\n                menu.setAttribute('aria-hidden', String(!open));\n                body.classList.toggle('body--menu-open', open);\n                if (!open) {\n                    resetMenuNav();\n                } else {\n                    closeDesktopDropdown();\n                    setSearchState(false);\n                }\n            }\n\n            function closeDesktopDropdown() {\n                if (header) {\n                    header.classList.remove('site-header--dropdown-open');\n                }\n                body.classList.remove('body--dropdown-open');\n                dropdownScrollPosition = window.scrollY || 0;\n                dropdownSections.forEach(function (section) {\n                    section.classList.remove('site-header__dropdown-section--active');\n                });\n                hideDropdownImages();\n                desktopNavItems.forEach(function (item) {\n                    item.classList.remove('site-nav__item--active');\n                    item.setAttribute('aria-expanded', 'false');\n                });\n                activeDesktopItem = null;\n            }\n\n            function openDesktopDropdown(trigger) {\n                if (!dropdown) { return; }\n                var key = trigger.getAttribute('data-nav-key');\n                if (!key) { return; }\n                dropdownSections.forEach(function (section) {\n                    var match = section.getAttribute('data-nav-content') === key;\n                    section.classList.toggle('site-header__dropdown-section--active', match);\n                });\n                updateDropdownImage(key);\n                desktopNavItems.forEach(function (item) {\n                    var isMatch = item === trigger;\n                    item.classList.toggle('site-nav__item--active', isMatch);\n                    item.setAttribute('aria-expanded', String(isMatch));\n                });\n                if (header) {\n                    header.classList.add('site-header--dropdown-open');\n                }\n                body.classList.add('body--dropdown-open');\n                activeDesktopItem = trigger;\n                dropdownScrollPosition = window.scrollY || 0;\n            }\n\n            function isDesktop() {\n                return desktopBreakpoint.matches;\n            }\n\n            if (searchToggle) {\n                searchToggle.addEventListener('click', toggleSearch);\n            }\n\n            if (searchClose) {\n                searchClose.addEventListener('click', function (event) {\n                    event.preventDefault();\n                    setSearchState(false);\n                });\n            }\n\n            if (searchSubmit) {\n                searchSubmit.addEventListener('click', handleSearchSubmit);\n            }\n\n            if (searchInput) {\n                searchInput.addEventListener('input', handleSearchInput);\n                searchInput.addEventListener('keydown', function (event) {\n                    if (event.key === 'Enter') {\n                        handleSearchSubmit(event);\n                    } else if (event.key === 'Escape') {\n                        setSearchState(false);\n                    }\n                });\n            }\n\n            window.addEventListener('resize', function () {\n                if (searchActive) {\n                    syncSearchInputWidth();\n                }\n            });\n\n            if (burger && menu) {\n                burger.addEventListener('click', function () {\n                    var expanded = burger.getAttribute('aria-expanded') === 'true';\n                    setMenuState(!expanded);\n                });\n\n                menu.addEventListener('click', function (event) {\n                    if (event.target === menu) {\n                        setMenuState(false);\n                    }\n                });\n            }\n\n            menuNavItems.forEach(function (item) {\n                item.addEventListener('click', function () {\n                    var isExpanded = item.getAttribute('aria-expanded') === 'true';\n                    item.setAttribute('aria-expanded', String(!isExpanded));\n                    item.classList.toggle('site-nav__item--active', !isExpanded);\n                });\n            });\n\n            loadMenuImages();\n\n            desktopNavItems.forEach(function (item) {\n                item.addEventListener('click', function (event) {\n                    if (!isDesktop()) {\n                        return;\n                    }\n                    event.preventDefault();\n                    var isActive = item.classList.contains('site-nav__item--active');\n                    if (isActive) {\n                        closeDesktopDropdown();\n                    } else {\n                        openDesktopDropdown(item);\n                    }\n                });\n            });\n\n            if (desktopBreakpoint.addEventListener) {\n                desktopBreakpoint.addEventListener('change', function (event) {\n                    if (!event.matches) {\n                        closeDesktopDropdown();\n                    }\n                });\n            } else if (desktopBreakpoint.addListener) {\n                desktopBreakpoint.addListener(function (event) {\n                    if (!event.matches) {\n                        closeDesktopDropdown();\n                    }\n                });\n            }\n\n            doc.addEventListener('click', function (event) {\n                if (!isDesktop()) { return; }\n                if (!header || !header.contains(event.target)) {\n                    closeDesktopDropdown();\n                    return;\n                }\n                if (event.target.closest('.site-header__dropdown-link')) {\n                    closeDesktopDropdown();\n                }\n            });\n\n            doc.addEventListener('keydown', function (event) {\n                if (event.key === 'Escape') {\n                    setMenuState(false);\n                    closeDesktopDropdown();\n                    setSearchState(false);\n                }\n            });\n\n            window.addEventListener('scroll', function () {\n                if (!isDesktop() || !activeDesktopItem) { return; }\n                var current = window.scrollY || 0;\n                if (Math.abs(current - dropdownScrollPosition) > 40) {\n                    closeDesktopDropdown();\n                }\n            }, { passive: true });\n        })();\n\n(function () {\n    var doc = document;\n    var header = doc.querySelector('.site-header');\n    var isAuthenticated = header && header.getAttribute('data-authenticated') === 'true';\n    var favoritesIconLinks = doc.querySelectorAll('[data-header-favorites]');\n    var cartIconLinks = doc.querySelectorAll('[data-header-cart]');\n    var favoritesCount = 0;\n    var cartCount = 0;\n    var cartTotal = 0;\n\n    function promptLoginPanel() {\n        if (typeof window.openLoginPanel === 'function') {\n            window.openLoginPanel();\n        } else {\n            window.location.href = '/login';\n        }\n    }\n\n    function updateFavoriteState(button, favorited) {\n        if (!button) { return; }\n        button.classList.toggle('product-card__favorite--active', favorited);\n        button.classList.toggle('product-view__favorite--active', favorited);\n        button.classList.toggle('is-favorited', favorited);\n        button.setAttribute('aria-pressed', String(favorited));\n        button.setAttribute('data-favorited', String(favorited));\n        button.setAttribute('aria-label', favorited ? 'Удалить из избранного' : 'Добавить в избранное');\n        var icon = button.querySelector('[data-favorite-icon]');\n        if (icon) {\n            icon.classList.toggle('is-favorited', favorited);\n        }\n        var card = button.closest('[data-product-card]');\n        if (card) {\n            card.setAttribute('data-favorited', String(favorited));\n        }\n    }\n\n    function setFavoritesIcon(active) {\n        favoritesIconLinks.forEach(function (link) {\n            link.classList.toggle('is-active', active);\n        });\n    }\n\n    function setCartIcon(active) {\n        cartIconLinks.forEach(function (link) {\n            link.classList.toggle('is-active', active);\n        });\n    }\n\n    function setCartTotalDisplay(total) {\n        var targets = doc.querySelectorAll('[data-cart-total]');\n        if (!targets.length) { return; }\n        var formatted = formatPrice(total);\n        targets.forEach(function (target) {\n            target.textContent = formatted;\n        });\n    }\n\n    function setCartCountDisplay(count) {\n        var targets = doc.querySelectorAll('[data-cart-count]');\n        if (!targets.length) { return; }\n        var formatted = count > 0 ? count + ' шт.' : '0 шт.';\n        targets.forEach(function (target) {\n            target.textContent = formatted;\n        });\n    }\n\n    function setCartAddButtonState(productId, inCart) {\n        if (!productId) { return; }\n        var buttons = doc.querySelectorAll('[data-cart-add][data-product-id=\"' + productId + '\"]');\n        buttons.forEach(function (button) {\n            if (!button.dataset.originalLabel) {\n                button.dataset.originalLabel = (button.textContent || '').trim();\n            }\n            if (inCart) {\n                button.classList.add('is-added');\n                button.textContent = 'в корзине';\n                button.setAttribute('aria-pressed', 'true');\n                button.setAttribute('data-in-cart', 'true');\n            } else {\n                button.classList.remove('is-added');\n                var label = button.dataset.originalLabel || 'добавить в корзину';\n                button.textContent = label;\n                button.removeAttribute('aria-pressed');\n                button.removeAttribute('data-in-cart');\n            }\n        });\n    }\n\n    function updateCartEmptyState() {\n        var itemsContainer = doc.querySelector('[data-cart-items]');\n        var emptyState = doc.querySelector('[data-cart-empty]');\n        var summary = doc.querySelector('[data-cart-summary]');\n        if (!itemsContainer || !emptyState) { return; }\n        var hasItems = Boolean(itemsContainer.querySelector('[data-cart-item]'));\n        emptyState.style.display = hasItems ? 'none' : '';\n        if (summary) {\n            summary.style.display = hasItems ? '' : 'none';\n        }\n        if (!hasItems) {\n            setCartTotalDisplay(0);\n            setCartCountDisplay(0);\n        }\n    }\n\n    function refreshFavoritesCount() {\n        fetch('/favorites/count', {\n            headers: { 'Accept': 'application/json' },\n            credentials: 'same-origin'\n        }).then(function (response) {\n            if (!response.ok) { throw new Error('favorites count failed'); }\n            return response.json();\n        }).then(function (data) {\n            favoritesCount = Number(data && data.count) || 0;\n            setFavoritesIcon(favoritesCount > 0);\n        }).catch(function () {});\n    }\n\n    function refreshCartState() {\n        fetch('/cart/count', {\n            headers: { 'Accept': 'application/json' },\n            credentials: 'same-origin'\n        }).then(function (response) {\n            if (!response.ok) { throw new Error('cart count failed'); }\n            return response.json();\n        }).then(function (data) {\n            cartCount = Number(data && data.count) || 0;\n            cartTotal = Number(data && data.total) || 0;\n            setCartIcon(cartCount > 0);\n            setCartTotalDisplay(cartTotal);\n            setCartCountDisplay(cartCount);\n            updateCartEmptyState();\n        }).catch(function () {});\n    }\n\n    doc.addEventListener('click', function (event) {\n        var trigger = event.target.closest('[data-favorite-toggle]');\n        if (trigger) {\n            var productId = trigger.getAttribute('data-product-id');\n            if (!productId) { return; }\n            event.preventDefault();\n            event.stopPropagation();\n            if (trigger.dataset.busy === 'true') {\n                return;\n            }\n            trigger.dataset.busy = 'true';\n            trigger.disabled = true;\n            var wasFavorited = trigger.getAttribute('data-favorited') === 'true';\n\n            fetch('/favorites/' + productId + '/toggle', {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json'\n                },\n                credentials: 'same-origin'\n            }).then(function (response) {\n                if (response.status === 401) {\n                    promptLoginPanel();\n                    return null;\n                }\n                if (!response.ok) {\n                    throw new Error('favorite toggle failed');\n                }\n                return response.json();\n            }).then(function (data) {\n                if (!data) { return; }\n                var favorited = Boolean(data.favorited);\n                var related = doc.querySelectorAll('[data-favorite-toggle][data-product-id=\"' + productId + '\"]');\n                related.forEach(function (button) {\n                    updateFavoriteState(button, favorited);\n                });\n                if (favorited && !wasFavorited) {\n                    favoritesCount += 1;\n                } else if (!favorited && wasFavorited) {\n                    favoritesCount = Math.max(favoritesCount - 1, 0);\n                }\n                setFavoritesIcon(favoritesCount > 0);\n            }).catch(function (error) {\n                console.error(error);\n            }).finally(function () {\n                delete trigger.dataset.busy;\n                trigger.disabled = false;\n            });\n            return;\n        }\n\n        var cartAdd = event.target.closest('[data-cart-add]');\n        if (cartAdd) {\n            event.preventDefault();\n            event.stopPropagation();\n            handleCartAdd(cartAdd);\n            return;\n        }\n\n        var cartIncrement = event.target.closest('[data-cart-increment]');\n        if (cartIncrement) {\n            event.preventDefault();\n            event.stopPropagation();\n            handleCartIncrement(cartIncrement);\n            return;\n        }\n\n        var cartDecrement = event.target.closest('[data-cart-decrement]');\n        if (cartDecrement) {\n            event.preventDefault();\n            event.stopPropagation();\n            handleCartDecrement(cartDecrement);\n            return;\n        }\n\n        var cartRemove = event.target.closest('[data-cart-remove]');\n        if (cartRemove) {\n            event.preventDefault();\n            event.stopPropagation();\n            handleCartRemove(cartRemove);\n            return;\n        }\n    });\n\n    function handleCartAdd(button) {\n        if (button.dataset.busy === 'true') { return; }\n        var productId = button.getAttribute('data-product-id');\n        if (!productId) { return; }\n        var sizeSelector = button.getAttribute('data-cart-size-source');\n        var sizeValue = '';\n        if (sizeSelector) {\n            var sizeTarget = doc.querySelector(sizeSelector);\n            if (sizeTarget) {\n                sizeValue = (sizeTarget.textContent || sizeTarget.value || '').trim();\n            }\n        }\n\n        button.dataset.busy = 'true';\n        button.disabled = true;\n\n        fetch('/cart/' + productId + '/add', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            credentials: 'same-origin',\n            body: JSON.stringify({ size: sizeValue })\n        }).then(function (response) {\n            if (response.status === 401) {\n                promptLoginPanel();\n                return null;\n            }\n            if (!response.ok) {\n                throw new Error('cart add failed');\n            }\n            return response.json();\n        }).then(function (data) {\n            if (!data) { return; }\n            cartCount = Number(data.cart_count) || 0;\n            cartTotal = Number(data.cart_total) || 0;\n            setCartIcon(cartCount > 0);\n            setCartTotalDisplay(cartTotal);\n            setCartCountDisplay(cartCount);\n            setCartAddButtonState(productId, true);\n        }).catch(function (error) {\n            console.error(error);\n        }).finally(function () {\n            delete button.dataset.busy;\n            button.disabled = false;\n        });\n    }\n\n    function handleCartRemove(button) {\n        if (button.dataset.busy === 'true') { return; }\n        var productId = button.getAttribute('data-product-id');\n        if (!productId) { return; }\n        var item = button.closest('[data-cart-item]');\n        var sizeValue = button.getAttribute('data-cart-size') || (item ? item.getAttribute('data-cart-size') : '') || '';\n\n        button.dataset.busy = 'true';\n        button.disabled = true;\n\n        fetch('/cart/' + productId + '/remove', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            credentials: 'same-origin',\n            body: JSON.stringify({ size: sizeValue })\n        }).then(function (response) {\n            if (response.status === 401) {\n                promptLoginPanel();\n                return null;\n            }\n            if (!response.ok) {\n                throw new Error('cart remove failed');\n            }\n            return response.json();\n        }).then(function (data) {\n            if (!data) { return; }\n            cartCount = Number(data.cart_count) || 0;\n            cartTotal = Number(data.cart_total) || 0;\n            setCartIcon(cartCount > 0);\n            setCartTotalDisplay(cartTotal);\n            setCartCountDisplay(cartCount);\n            if (item) {\n                item.remove();\n            }\n            updateCartEmptyState();\n            setCartAddButtonState(productId, false);\n        }).catch(function (error) {\n            console.error(error);\n        }).finally(function () {\n            delete button.dataset.busy;\n            button.disabled = false;\n        });\n    }\n\n    function updateCartItemVisuals(item, quantity) {\n        if (!item) { return; }\n        var quantityNode = item.querySelector('[data-cart-quantity-value]');\n        if (quantityNode) {\n            quantityNode.textContent = String(quantity);\n        }\n        var priceValue = Number(item.getAttribute('data-product-price')) || 0;\n        var sumNode = item.querySelector('[data-cart-item-sum]');\n        if (sumNode) {\n            sumNode.textContent = formatPrice(priceValue * quantity);\n        }\n        var decrementButton = item.querySelector('[data-cart-decrement]');\n        if (decrementButton) {\n            decrementButton.disabled = false;\n        }\n    }\n\n    function handleCartIncrement(button) {\n        if (button.dataset.busy === 'true') { return; }\n        var item = button.closest('[data-cart-item]');\n        if (!item) { return; }\n        var productId = button.getAttribute('data-product-id') || item.getAttribute('data-product-id');\n        if (!productId) { return; }\n        var sizeValue = button.getAttribute('data-cart-size') || item.getAttribute('data-cart-size') || '';\n\n        button.dataset.busy = 'true';\n        button.disabled = true;\n\n        fetch('/cart/' + productId + '/add', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            credentials: 'same-origin',\n            body: JSON.stringify({ size: sizeValue })\n        }).then(function (response) {\n            if (response.status === 401) {\n                promptLoginPanel();\n                return null;\n            }\n            if (!response.ok) {\n                throw new Error('cart increment failed');\n            }\n            return response.json();\n        }).then(function (data) {\n            if (!data) { return; }\n            cartCount = Number(data.cart_count) || 0;\n            cartTotal = Number(data.cart_total) || 0;\n            setCartIcon(cartCount > 0);\n            setCartTotalDisplay(cartTotal);\n            setCartCountDisplay(cartCount);\n            var quantity = Number(data.item_quantity);\n            if (!Number.isFinite(quantity) || quantity <= 0) {\n                var current = item.querySelector('[data-cart-quantity-value]');\n                quantity = Number(current ? current.textContent : 0) + 1;\n            }\n            updateCartItemVisuals(item, quantity);\n        }).catch(function (error) {\n            console.error(error);\n        }).finally(function () {\n            delete button.dataset.busy;\n            button.disabled = false;\n        });\n    }\n\n    function handleCartDecrement(button) {\n        if (button.dataset.busy === 'true') { return; }\n        var item = button.closest('[data-cart-item]');\n        if (!item) { return; }\n        var productId = button.getAttribute('data-product-id') || item.getAttribute('data-product-id');\n        if (!productId) { return; }\n        var sizeValue = button.getAttribute('data-cart-size') || item.getAttribute('data-cart-size') || '';\n\n        button.dataset.busy = 'true';\n        button.disabled = true;\n\n        fetch('/cart/' + productId + '/decrement', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            credentials: 'same-origin',\n            body: JSON.stringify({ size: sizeValue })\n        }).then(function (response) {\n            if (response.status === 401) {\n                promptLoginPanel();\n                return null;\n            }\n            if (!response.ok) {\n                throw new Error('cart decrement failed');\n            }\n            return response.json();\n        }).then(function (data) {\n            if (!data) { return; }\n            cartCount = Number(data.cart_count) || 0;\n            cartTotal = Number(data.cart_total) || 0;\n            setCartIcon(cartCount > 0);\n            setCartTotalDisplay(cartTotal);\n            setCartCountDisplay(cartCount);\n            var quantity = Number(data.item_quantity) || 0;\n            if (quantity <= 0) {\n                item.remove();\n                updateCartEmptyState();\n                setCartAddButtonState(productId, false);\n            } else {\n                updateCartItemVisuals(item, quantity);\n            }\n        }).catch(function (error) {\n            console.error(error);\n        }).finally(function () {\n            delete button.dataset.busy;\n            if (button.isConnected) {\n                button.disabled = false;\n            }\n        });\n    }\n\n    function syncCartDecrementState() {\n        var items = doc.querySelectorAll('[data-cart-item]');\n        items.forEach(function (item) {\n            var decrementButton = item.querySelector('[data-cart-decrement]');\n            if (!decrementButton) { return; }\n            decrementButton.disabled = false;\n        });\n    }\n\n    refreshFavoritesCount();\n    refreshCartState();\n    syncCartDecrementState();\n})();\n\n(function () {\n    var doc = document;\n    var body = document.body;\n    var loginPanel = doc.querySelector('[data-login-panel]');\n    var registerPanel = doc.querySelector('[data-register-panel]');\n    var forgotPanel = doc.querySelector('[data-forgot-panel]');\n    if (!loginPanel && !registerPanel && !forgotPanel) { return; }\n\n    var loginOverlay = loginPanel ? loginPanel.querySelector('[data-login-overlay]') : null;\n    var loginClose = loginPanel ? loginPanel.querySelector('[data-login-close]') : null;\n    var loginEmailInput = loginPanel ? loginPanel.querySelector('[data-login-email]') : null;\n    var registerOverlay = registerPanel ? registerPanel.querySelector('[data-register-overlay]') : null;\n    var registerClose = registerPanel ? registerPanel.querySelector('[data-register-close]') : null;\n    var registerFirstInput = registerPanel ? registerPanel.querySelector('input[name=\"first_name\"]') : null;\n    var registerPassword = registerPanel ? registerPanel.querySelector('[data-register-password]') : null;\n    var registerConfirm = registerPanel ? registerPanel.querySelector('[data-register-confirm]') : null;\n    var registerForm = registerPanel ? registerPanel.querySelector('[data-register-form]') : null;\n    var registerSubmit = registerPanel ? registerPanel.querySelector('[data-register-submit]') : null;\n    var registerRequiredInputs = registerForm ? registerForm.querySelectorAll('input[required]') : [];\n    var forgotOverlay = forgotPanel ? forgotPanel.querySelector('[data-forgot-overlay]') : null;\n    var forgotClose = forgotPanel ? forgotPanel.querySelector('[data-forgot-close]') : null;\n    var forgotEmailInput = forgotPanel ? forgotPanel.querySelector('[data-forgot-email]') : null;\n\n    var activePanel = null;\n    var activeTrigger = null;\n\n    function lockScroll() {\n        body.classList.add('body--login-open');\n    }\n\n    function unlockScroll() {\n        body.classList.remove('body--login-open');\n    }\n\n    function closePanel(panel) {\n        if (!panel || !panel.classList.contains('is-open')) { return; }\n        panel.classList.remove('is-open');\n        panel.setAttribute('aria-hidden', 'true');\n        if (panel === activePanel) {\n            activePanel = null;\n            unlockScroll();\n            if (activeTrigger && typeof activeTrigger.focus === 'function') {\n                activeTrigger.focus();\n            }\n            activeTrigger = null;\n        }\n    }\n\n    function openPanel(panel, focusTarget, trigger) {\n        if (!panel) { return; }\n        if (activePanel && activePanel !== panel) {\n            closePanel(activePanel);\n        }\n        if (panel.classList.contains('is-open')) {\n            activeTrigger = trigger || activeTrigger;\n            return;\n        }\n        activeTrigger = trigger || null;\n        panel.classList.add('is-open');\n        panel.setAttribute('aria-hidden', 'false');\n        activePanel = panel;\n        lockScroll();\n        if (focusTarget) {\n            window.requestAnimationFrame(function () {\n                if (typeof focusTarget.focus === 'function') {\n                    focusTarget.focus();\n                    if (typeof focusTarget.select === 'function') {\n                        focusTarget.select();\n                    }\n                }\n            });\n        }\n    }\n\n    function openLoginPanel(trigger) {\n        openPanel(loginPanel, loginEmailInput, trigger);\n    }\n\n    function openRegisterPanel(trigger) {\n        openPanel(registerPanel, registerFirstInput, trigger);\n        updateRegisterSubmitState();\n    }\n\n    function openForgotPanel(trigger) {\n        openPanel(forgotPanel, forgotEmailInput, trigger);\n    }\n\n    var loginTriggers = doc.querySelectorAll('[data-login-open=\"true\"]');\n    loginTriggers.forEach(function (trigger) {\n        trigger.addEventListener('click', function (event) {\n            event.preventDefault();\n            openLoginPanel(trigger);\n        });\n    });\n\n    var registerTriggers = doc.querySelectorAll('[data-register-open]');\n    registerTriggers.forEach(function (trigger) {\n        trigger.addEventListener('click', function (event) {\n            event.preventDefault();\n            openRegisterPanel(trigger);\n        });\n    });\n\n    var forgotTriggers = doc.querySelectorAll('[data-forgot-open]');\n    forgotTriggers.forEach(function (trigger) {\n        trigger.addEventListener('click', function (event) {\n            event.preventDefault();\n            openForgotPanel(trigger);\n        });\n    });\n\n    if (loginOverlay) {\n        loginOverlay.addEventListener('click', function (event) {\n            event.preventDefault();\n            closePanel(loginPanel);\n        });\n    }\n\n    if (loginClose) {\n        loginClose.addEventListener('click', function (event) {\n            event.preventDefault();\n            closePanel(loginPanel);\n        });\n    }\n\n    if (registerOverlay) {\n        registerOverlay.addEventListener('click', function (event) {\n            event.preventDefault();\n            closePanel(registerPanel);\n        });\n    }\n\n    if (registerClose) {\n        registerClose.addEventListener('click', function (event) {\n            event.preventDefault();\n            closePanel(registerPanel);\n        });\n    }\n\n    if (forgotOverlay) {\n        forgotOverlay.addEventListener('click', function (event) {\n            event.preventDefault();\n            var panel = event.currentTarget.closest('[data-forgot-panel]');\n            closePanel(panel || forgotPanel);\n        });\n    }\n\n    if (forgotClose) {\n        forgotClose.addEventListener('click', function (event) {\n            event.preventDefault();\n            var panel = event.currentTarget.closest('[data-forgot-panel]');\n            closePanel(panel || forgotPanel);\n        });\n    }\n\n    doc.addEventListener('keydown', function (event) {\n        if (event.key === 'Escape' && activePanel) {\n            closePanel(activePanel);\n        }\n    });\n\n    function handleQueryParam(key, openFn) {\n        var params = new URLSearchParams(window.location.search);\n        if (params.get(key) === 'open') {\n            openFn();\n            params.delete(key);\n            var rest = params.toString();\n            var replacement = window.location.pathname + (rest ? '?' + rest : '') + window.location.hash;\n            window.history.replaceState({}, document.title, replacement);\n        }\n    }\n\n    handleQueryParam('login', openLoginPanel);\n    handleQueryParam('register', openRegisterPanel);\n    handleQueryParam('forgot', openForgotPanel);\n\n    window.openLoginPanel = function () {\n        openLoginPanel();\n    };\n\n    window.openRegisterPanel = function () {\n        openRegisterPanel();\n    };\n\n    window.openForgotPanel = function () {\n        openForgotPanel();\n    };\n\n    window.closeLoginPanel = function () {\n        closePanel(loginPanel);\n    };\n\n    window.closeForgotPanel = function () {\n        closePanel(forgotPanel);\n    };\n\n    function validateRegisterPasswords() {\n        if (!registerPassword || !registerConfirm) { return true; }\n        if (registerPassword.value !== registerConfirm.value) {\n            registerConfirm.setCustomValidity('Пароли не совпадают');\n            return false;\n        }\n        registerConfirm.setCustomValidity('');\n        return true;\n    }\n\n    function updateRegisterSubmitState() {\n        if (!registerSubmit) { return; }\n        var allFilled = true;\n        registerRequiredInputs.forEach(function (input) {\n            if (input.type === 'checkbox') {\n                if (!input.checked) {\n                    allFilled = false;\n                }\n            } else if (!input.value || !input.value.trim()) {\n                allFilled = false;\n            }\n        });\n        var passwordsValid = validateRegisterPasswords();\n        registerSubmit.disabled = !(allFilled && passwordsValid);\n    }\n\n    if (registerPassword && registerConfirm) {\n        registerPassword.addEventListener('input', function () {\n            validateRegisterPasswords();\n            updateRegisterSubmitState();\n        });\n        registerConfirm.addEventListener('input', function () {\n            validateRegisterPasswords();\n            updateRegisterSubmitState();\n        });\n    }\n\n    if (registerRequiredInputs.length) {\n        registerRequiredInputs.forEach(function (input) {\n            var handler = function () {\n                updateRegisterSubmitState();\n            };\n            input.addEventListener(input.type === 'checkbox' ? 'change' : 'input', handler);\n        });\n    }\n\n    if (registerForm) {\n        registerForm.addEventListener('submit', function (event) {\n            if (!validateRegisterPasswords()) {\n                event.preventDefault();\n                registerConfirm.focus();\n                return;\n            }\n            updateRegisterSubmitState();\n            if (registerSubmit && registerSubmit.disabled) {\n                event.preventDefault();\n            }\n        });\n    }\n\n    updateRegisterSubmitState();\n})();\n    </script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
